"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getNameDenylistFromContract = exports.getPoisFromContract = exports.getCatalystServersFromDAO = void 0;
async function getCatalystServersFromDAO(contract) {
    const nodes = [];
    for (let i = 0; i < (await contract.catalystCount()); i++) {
        const record = await contract.catalystById(await contract.catalystIds(i));
        const { id, owner, domain } = record;
        if (domain.startsWith('http://')) {
            console.warn('Catalyst node address using http protocol, skipping');
            continue;
        }
        let address = domain;
        if (!address.startsWith('https://')) {
            address = 'https://' + address;
        }
        // trim url in case it starts/ends with a blank
        address = address.trim();
        nodes.push({
            address,
            owner,
            id
        });
    }
    return nodes;
}
exports.getCatalystServersFromDAO = getCatalystServersFromDAO;
async function getValuesFromListContract(contract) {
    const count = await contract.size();
    const values = [];
    for (let i = 0; i < count; i++) {
        values.push(contract.get(i));
    }
    return Promise.all(values);
}
function getPoisFromContract(contract) {
    return getValuesFromListContract(contract);
}
exports.getPoisFromContract = getPoisFromContract;
function getNameDenylistFromContract(contract) {
    return getValuesFromListContract(contract);
}
exports.getNameDenylistFromContract = getNameDenylistFromContract;
//# sourceMappingURL=utils.js.map
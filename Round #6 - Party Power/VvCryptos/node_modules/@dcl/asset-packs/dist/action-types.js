import { Schemas } from '@dcl/ecs';
import { ComponentName, getComponent, } from './definitions';
export const EMPTY = {
    type: 'object',
    properties: {},
    serializationType: 'map',
};
export function addActionType(engine, type, schema) {
    const ActionTypes = getComponent(ComponentName.ACTION_TYPES, engine);
    const actionTypes = ActionTypes.getOrCreateMutable(engine.RootEntity);
    const actionType = {
        type,
        jsonSchema: JSON.stringify(schema?.jsonSchema || Schemas.Map({}).jsonSchema),
    };
    actionTypes.value = [
        ...actionTypes.value.filter(($) => $.type !== actionType.type),
        actionType,
    ];
}
export function getActionSchema(engine, type) {
    const ActionTypes = getComponent(ComponentName.ACTION_TYPES, engine);
    const actionTypes = ActionTypes.get(engine.RootEntity);
    const actionType = actionTypes.value.find(($) => $.type === type);
    const jsonSchema = actionType
        ? JSON.parse(actionType.jsonSchema)
        : EMPTY;
    return Schemas.fromJson(jsonSchema);
}
export function getActionTypes(engine) {
    const ActionTypes = getComponent(ComponentName.ACTION_TYPES, engine);
    const actionTypes = ActionTypes.get(engine.RootEntity);
    return actionTypes.value.map(($) => $.type);
}
export function getPayload(action) {
    return JSON.parse(action.jsonPayload);
}
export function getJson(payload) {
    return JSON.stringify(payload);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aW9uLXR5cGVzLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vc3JjL2FjdGlvbi10eXBlcy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQXdDLE9BQU8sRUFBRSxNQUFNLFVBQVUsQ0FBQTtBQUN4RSxPQUFPLEVBS0wsYUFBYSxFQUNiLFlBQVksR0FDYixNQUFNLGVBQWUsQ0FBQTtBQUV0QixNQUFNLENBQUMsTUFBTSxLQUFLLEdBQXVCO0lBQ3ZDLElBQUksRUFBRSxRQUFRO0lBQ2QsVUFBVSxFQUFFLEVBQUU7SUFDZCxpQkFBaUIsRUFBRSxLQUFLO0NBQ3pCLENBQUE7QUFFRCxNQUFNLFVBQVUsYUFBYSxDQUMzQixNQUFlLEVBQ2YsSUFBWSxFQUNaLE1BQVU7SUFFVixNQUFNLFdBQVcsR0FBRyxZQUFZLENBQzlCLGFBQWEsQ0FBQyxZQUFZLEVBQzFCLE1BQU0sQ0FDUCxDQUFBO0lBQ0QsTUFBTSxXQUFXLEdBQUcsV0FBVyxDQUFDLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUNyRSxNQUFNLFVBQVUsR0FBRztRQUNqQixJQUFJO1FBQ0osVUFBVSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQ3hCLE1BQU0sRUFBRSxVQUFVLElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsQ0FBQyxVQUFVLENBQ2pEO0tBQ0YsQ0FBQTtJQUNELFdBQVcsQ0FBQyxLQUFLLEdBQUc7UUFDbEIsR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxVQUFVLENBQUMsSUFBSSxDQUFDO1FBQzlELFVBQVU7S0FDWCxDQUFBO0FBQ0gsQ0FBQztBQUVELE1BQU0sVUFBVSxlQUFlLENBQWMsTUFBZSxFQUFFLElBQVk7SUFDeEUsTUFBTSxXQUFXLEdBQUcsWUFBWSxDQUM5QixhQUFhLENBQUMsWUFBWSxFQUMxQixNQUFNLENBQ1AsQ0FBQTtJQUNELE1BQU0sV0FBVyxHQUFHLFdBQVcsQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUFBO0lBQ3RELE1BQU0sVUFBVSxHQUFHLFdBQVcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLElBQUksQ0FBQyxDQUFBO0lBQ2pFLE1BQU0sVUFBVSxHQUF1QixVQUFVO1FBQy9DLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxVQUFVLENBQUM7UUFDbkMsQ0FBQyxDQUFDLEtBQUssQ0FBQTtJQUNULE9BQU8sT0FBTyxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQWUsQ0FBQTtBQUNuRCxDQUFDO0FBRUQsTUFBTSxVQUFVLGNBQWMsQ0FBQyxNQUFlO0lBQzVDLE1BQU0sV0FBVyxHQUFHLFlBQVksQ0FDOUIsYUFBYSxDQUFDLFlBQVksRUFDMUIsTUFBTSxDQUNQLENBQUE7SUFDRCxNQUFNLFdBQVcsR0FBRyxXQUFXLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUN0RCxPQUFPLFdBQVcsQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUE7QUFDN0MsQ0FBQztBQUVELE1BQU0sVUFBVSxVQUFVLENBQXVCLE1BQWM7SUFDN0QsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxXQUFXLENBQXFCLENBQUE7QUFDM0QsQ0FBQztBQUVELE1BQU0sVUFBVSxPQUFPLENBQXVCLE9BQXlCO0lBQ3JFLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQTtBQUNoQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSUVuZ2luZSwgSVNjaGVtYSwgSnNvblNjaGVtYUV4dGVuZGVkLCBTY2hlbWFzIH0gZnJvbSAnQGRjbC9lY3MnXG5pbXBvcnQge1xuICBBY3Rpb24sXG4gIEFjdGlvblBheWxvYWQsXG4gIEFjdGlvblR5cGUsXG4gIEFjdGlvblR5cGVzLFxuICBDb21wb25lbnROYW1lLFxuICBnZXRDb21wb25lbnQsXG59IGZyb20gJy4vZGVmaW5pdGlvbnMnXG5cbmV4cG9ydCBjb25zdCBFTVBUWTogSnNvblNjaGVtYUV4dGVuZGVkID0ge1xuICB0eXBlOiAnb2JqZWN0JyxcbiAgcHJvcGVydGllczoge30sXG4gIHNlcmlhbGl6YXRpb25UeXBlOiAnbWFwJyxcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGFkZEFjdGlvblR5cGU8VCBleHRlbmRzIElTY2hlbWE+KFxuICBlbmdpbmU6IElFbmdpbmUsXG4gIHR5cGU6IHN0cmluZyxcbiAgc2NoZW1hPzogVCxcbikge1xuICBjb25zdCBBY3Rpb25UeXBlcyA9IGdldENvbXBvbmVudDxBY3Rpb25UeXBlcz4oXG4gICAgQ29tcG9uZW50TmFtZS5BQ1RJT05fVFlQRVMsXG4gICAgZW5naW5lLFxuICApXG4gIGNvbnN0IGFjdGlvblR5cGVzID0gQWN0aW9uVHlwZXMuZ2V0T3JDcmVhdGVNdXRhYmxlKGVuZ2luZS5Sb290RW50aXR5KVxuICBjb25zdCBhY3Rpb25UeXBlID0ge1xuICAgIHR5cGUsXG4gICAganNvblNjaGVtYTogSlNPTi5zdHJpbmdpZnkoXG4gICAgICBzY2hlbWE/Lmpzb25TY2hlbWEgfHwgU2NoZW1hcy5NYXAoe30pLmpzb25TY2hlbWEsXG4gICAgKSxcbiAgfVxuICBhY3Rpb25UeXBlcy52YWx1ZSA9IFtcbiAgICAuLi5hY3Rpb25UeXBlcy52YWx1ZS5maWx0ZXIoKCQpID0+ICQudHlwZSAhPT0gYWN0aW9uVHlwZS50eXBlKSxcbiAgICBhY3Rpb25UeXBlLFxuICBdXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRBY3Rpb25TY2hlbWE8VCA9IHVua25vd24+KGVuZ2luZTogSUVuZ2luZSwgdHlwZTogc3RyaW5nKSB7XG4gIGNvbnN0IEFjdGlvblR5cGVzID0gZ2V0Q29tcG9uZW50PEFjdGlvblR5cGVzPihcbiAgICBDb21wb25lbnROYW1lLkFDVElPTl9UWVBFUyxcbiAgICBlbmdpbmUsXG4gIClcbiAgY29uc3QgYWN0aW9uVHlwZXMgPSBBY3Rpb25UeXBlcy5nZXQoZW5naW5lLlJvb3RFbnRpdHkpXG4gIGNvbnN0IGFjdGlvblR5cGUgPSBhY3Rpb25UeXBlcy52YWx1ZS5maW5kKCgkKSA9PiAkLnR5cGUgPT09IHR5cGUpXG4gIGNvbnN0IGpzb25TY2hlbWE6IEpzb25TY2hlbWFFeHRlbmRlZCA9IGFjdGlvblR5cGVcbiAgICA/IEpTT04ucGFyc2UoYWN0aW9uVHlwZS5qc29uU2NoZW1hKVxuICAgIDogRU1QVFlcbiAgcmV0dXJuIFNjaGVtYXMuZnJvbUpzb24oanNvblNjaGVtYSkgYXMgSVNjaGVtYTxUPlxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0QWN0aW9uVHlwZXMoZW5naW5lOiBJRW5naW5lKSB7XG4gIGNvbnN0IEFjdGlvblR5cGVzID0gZ2V0Q29tcG9uZW50PEFjdGlvblR5cGVzPihcbiAgICBDb21wb25lbnROYW1lLkFDVElPTl9UWVBFUyxcbiAgICBlbmdpbmUsXG4gIClcbiAgY29uc3QgYWN0aW9uVHlwZXMgPSBBY3Rpb25UeXBlcy5nZXQoZW5naW5lLlJvb3RFbnRpdHkpXG4gIHJldHVybiBhY3Rpb25UeXBlcy52YWx1ZS5tYXAoKCQpID0+ICQudHlwZSlcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldFBheWxvYWQ8VCBleHRlbmRzIEFjdGlvblR5cGU+KGFjdGlvbjogQWN0aW9uKSB7XG4gIHJldHVybiBKU09OLnBhcnNlKGFjdGlvbi5qc29uUGF5bG9hZCkgYXMgQWN0aW9uUGF5bG9hZDxUPlxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0SnNvbjxUIGV4dGVuZHMgQWN0aW9uVHlwZT4ocGF5bG9hZDogQWN0aW9uUGF5bG9hZDxUPikge1xuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkocGF5bG9hZClcbn1cbiJdfQ==
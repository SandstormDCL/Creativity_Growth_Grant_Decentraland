"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createProcessSpawnerComponent = void 0;
function createProcessSpawnerComponent(spawnFn) {
    return {
        exec(cwd, command, args, { env, silent } = {}) {
            return new Promise((resolve, reject) => {
                const child = spawnFn(command, args, {
                    shell: true,
                    cwd,
                    env: { ...process.env, NODE_ENV: '', ...env }
                });
                if (!silent) {
                    child.stdout.pipe(process.stdout);
                    child.stderr.pipe(process.stderr);
                }
                child.on('close', (code) => {
                    if (code !== 0) {
                        const _ = `${command} ${args.join(' ')}`;
                        reject(new Error(`Command "${_}" exited with code ${code}. Please try running the command manually`));
                        return;
                    }
                    resolve(undefined);
                });
            });
        }
    };
}
exports.createProcessSpawnerComponent = createProcessSpawnerComponent;
//# sourceMappingURL=exec.js.map